---
title: "chapter5"
author: "Susanne Csader"
date: "11/19/2020"
output: html_document
---
# Dimensionality reduction techniques

**1. explore the data set**

```{r}
human<-read.table("http://s3.amazonaws.com/assets.datacamp.com/production/course_2218/datasets/human2.txt", sep=",", header=TRUE)
library(MASS)
library(tidyverse)
library(ggplot2)
library(corrplot)
library(GGally)
pairs(human)
ggpairs(human, lower = list(combo = wrap("facethist", bins = 20)))
human_cor<- cor(human)%>%round(2)
human_cor
corrplot.mixed(human_cor, lower.col="black", number.cex = .8 )



str(human)
dim(human)
summary(human)
```

This data set contains 8 variables and 155 observations. The variables are: Population.with.Secondary.Education rate (Edu2FM), Labour.Force.Participation.Rate.(Labo.FM), Expected.Years.of.Education (Edu.Exp), Life.Expectancy.at.Birth (Life.Exp), Gross.National.Income..GNI..per.Capita (GNI), Maternal.Mortality.Ratio (MAT.Mor.), Adolescent.Birth.Rate (Ado.Birth), Percent.Representation.in.Parliament (Parti.F).
The ggplot and the corrplot.mixed shows the correlations between the variables. For example, the the life expectation is strongly correlated with the expected education. That means that the higher the the education the longer you life. Also the lower the education level the higher the maternal mortality rate.And of course the higher the maternal mortality rate the lower the life expectancy (highest negative correlation). 

**2. PCA**
```{r}
pca_hum<-prcomp(human)
s<-summary(pca_hum)
s
pc_pr <- round(100*s$importance[2,], digits = 1)
pc_pr
pc_lab <- paste0(names(pc_pr), " (", pc_pr, "%)")
biplot(pca_hum, cex = c(0.8, 1.5), col = c("lightslateblue", "cyan1"), xlab = pc_lab[1], ylab = pc_lab[2])
```

**3. standardized PCA**

```{r}
human_std<-scale(human)
pca_human<-prcomp(human_std)
s1<-summary(pca_human)
s1
pc_pr1 <- round(100*s1$importance[2,], digits = 1)
pc_pr1
pc_lab1 <- paste0(names(pc_pr1), " (", pc_pr1, "%)")
biplot(pca_human, cex = c(0.8, 1.5), col = c("lightslateblue", "cyan1"), xlab = pc_lab1[1], ylab = pc_lab1[2])
```

**4. personal interpretation**

**5. MCA**

```{r}
library(FactoMineR)
data(tea)
str(tea)
dim(tea)

keep_columns <- c("Tea", "How", "how", "sugar", "where", "lunch")
tea_time <- select(tea, one_of(keep_columns))
summary(tea_time)
str(tea_time)
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar(colour='blue') + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))

mca <- MCA(tea_time, graph = FALSE)
summary(mca)
plot(mca, invisible=c("ind"), habillage = "quali")
```


![whoop whoop, it still makes fun :)](https://media.giphy.com/media/LMny8mw5VnvyKln1Jt/giphy.gif)
